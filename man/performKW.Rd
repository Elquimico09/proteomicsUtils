% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/performKW.R
\name{performKW}
\alias{performKW}
\title{Perform Kruskal-Wallis Test on Multiple Cohorts}
\usage{
performKW(..., comparisons = "all", p_adjust = "BH", log_scale = TRUE)
}
\arguments{
\item{...}{Data frames, each containing data for one cohort.
All data frames must have the same number of rows.}

\item{comparisons}{Which pairwise comparisons to include in output. Options:
- "all" (default): include all pairwise comparisons
- A list of character vectors specifying pairs, e.g.,
  list(c("control", "treated"), c("control", "placebo")).
  Group names must match the variable names passed in.}

\item{p_adjust}{Method for p-value adjustment in Dunn's test. Default is "BH" (Benjamini-Hochberg).
Other options: "bonferroni", "holm", "hochberg", "hommel", "BY", "none".}

\item{log_scale}{Logical; whether input data are already on a log scale.
- TRUE (default): fold change is computed as mean(group2) - mean(group1)
- FALSE: fold change is computed as mean(group2) / mean(group1), and log2fc
  is computed as log2(fold change)}
}
\value{
A named list with:
  - data: A data frame with the combined original data plus computed columns:
    kw_pvalue, dunn_pvalue_X_Y, foldchange_X_Y, and log2fc_X_Y.
  - cohort_columns: A named list where each element corresponds to a cohort
    and contains the original column names for that cohort.
}
\description{
Takes data frames as arguments, each belonging to a cohort, and performs a non-parametric
Kruskal-Wallis test on each row. This is the non-parametric alternative to ANOVA for comparing
three or more groups. Works dynamically with 3 or more groups. The function returns results
with the p-value from the Kruskal-Wallis test, Dunn's test p-values for pairwise comparisons,
and fold changes for each pairwise comparison. Column names are automatically derived from
the variable names passed in.
}
\examples{
# For 3 groups (all pairwise comparisons)
result <- performKW(control, treated, placebo)
result$data
result$cohort_columns

# Only specific comparisons
result <- performKW(control, treated, placebo,
                    comparisons = list(c("control", "treated"),
                                       c("control", "placebo")))
}
