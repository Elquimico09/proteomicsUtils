% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilities.R, R/utilities_old.R
\name{impute_minprob}
\alias{impute_minprob}
\title{Impute Missing Values using a Shifted Normal Distribution (MinProb)}
\usage{
impute_minprob(
  data_matrix,
  shift = 1.8,
  scale = 0.3,
  warn_rows_with_few_values = TRUE
)

impute_minprob(
  data_matrix,
  shift = 1.8,
  scale = 0.3,
  warn_rows_with_few_values = TRUE
)
}
\arguments{
\item{data_matrix}{A numeric matrix where rows represent features (e.g., proteins)
and columns represent samples (replicates). Missing values should be NA.
It is highly recommended to use log-transformed data as input.}

\item{shift}{Numeric scalar. Controls how many standard deviations the mean
of the imputation distribution is shifted *down* from the observed mean
for that row. Default is 1.8 (a common value used in Perseus).}

\item{scale}{Numeric scalar. Controls the standard deviation of the imputation
distribution as a fraction of the observed standard deviation for that row.
Default is 0.3 (a common value used in Perseus).}

\item{warn_rows_with_few_values}{Logical. If TRUE (default), prints a warning
for rows where imputation could not be performed due to having fewer than 2
observed values (mean/sd cannot be reliably calculated). NAs will remain
in these rows.}
}
\value{
A numeric matrix with the same dimensions as `data_matrix`, where
  NA values have been imputed based on the described method for rows with
  sufficient observed data. Rows with insufficient data will retain NAs.

A numeric matrix with the same dimensions as `data_matrix`, where
  NA values have been imputed based on the described method for rows with
  sufficient observed data. Rows with insufficient data will retain NAs.
}
\description{
Imputes missing values (NA) in a numeric matrix using random draws
from a normal distribution tailored for each row (protein). The distribution's
mean is shifted down from the row's observed mean, and its standard deviation
is scaled down from the row's observed standard deviation. This method is
often used for proteomics data assuming missingness is primarily due to
low abundance (MNAR / left-censored).

Imputes missing values (NA) in a numeric matrix using random draws
from a normal distribution tailored for each row (protein). The distribution's
mean is shifted down from the row's observed mean, and its standard deviation
is scaled down from the row's observed standard deviation. This method is
often used for proteomics data assuming missingness is primarily due to
low abundance (MNAR / left-censored).
}
\examples{
# --- Create Sample Data (log2 scale recommended) ---
set.seed(123) # for reproducibility
mat <- matrix(rnorm(50, mean = 8, sd = 1.5), nrow = 10, ncol = 5)
colnames(mat) <- paste0("Sample_", 1:5)
rownames(mat) <- paste0("Protein_", 1:10)

# Introduce some NAs, especially for lower abundance proteins (simulate MNAR)
mat[1, 1:3] <- NA  # Protein 1 low in samples 1-3
mat[5, 4:5] <- NA  # Protein 5 low in samples 4-5
mat[8, 2] <- NA   # Sporadic NA
mat[9, ] <- NA    # Protein 9 completely missing
mat[10, 1] <- rnorm(1, mean=4, sd=0.5) # Add one lower value protein
mat[10, 2:5] <- NA

print("Original Matrix:")
print(mat)

# --- Perform Imputation ---
imputed_matrix <- impute_minprob(mat, shift = 1.8, scale = 0.3)

print("Imputed Matrix:")
print(imputed_matrix)

# Check if NAs remain (should be Protein_9 and Protein_10)
print("Remaining NAs after imputation:")
print(which(is.na(imputed_matrix), arr.ind = TRUE))

# Check imputed values are lower than observed for Protein 1
print("Protein 1 original observed:")
print(mat[1, !is.na(mat[1,])])
print("Protein 1 imputed values:")
print(imputed_matrix[1, is.na(mat[1,])])

# --- Create Sample Data (log2 scale recommended) ---
set.seed(123) # for reproducibility
mat <- matrix(rnorm(50, mean = 8, sd = 1.5), nrow = 10, ncol = 5)
colnames(mat) <- paste0("Sample_", 1:5)
rownames(mat) <- paste0("Protein_", 1:10)

# Introduce some NAs, especially for lower abundance proteins (simulate MNAR)
mat[1, 1:3] <- NA  # Protein 1 low in samples 1-3
mat[5, 4:5] <- NA  # Protein 5 low in samples 4-5
mat[8, 2] <- NA   # Sporadic NA
mat[9, ] <- NA    # Protein 9 completely missing
mat[10, 1] <- rnorm(1, mean=4, sd=0.5) # Add one lower value protein
mat[10, 2:5] <- NA

print("Original Matrix:")
print(mat)

# --- Perform Imputation ---
imputed_matrix <- impute_minprob(mat, shift = 1.8, scale = 0.3)

print("Imputed Matrix:")
print(imputed_matrix)

# Check if NAs remain (should be Protein_9 and Protein_10)
print("Remaining NAs after imputation:")
print(which(is.na(imputed_matrix), arr.ind = TRUE))

# Check imputed values are lower than observed for Protein 1
print("Protein 1 original observed:")
print(mat[1, !is.na(mat[1,])])
print("Protein 1 imputed values:")
print(imputed_matrix[1, is.na(mat[1,])])

}
