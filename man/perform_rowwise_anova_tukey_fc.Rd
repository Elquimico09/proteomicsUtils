% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utilities.R
\name{perform_rowwise_anova_tukey_fc}
\alias{perform_rowwise_anova_tukey_fc}
\title{Perform Row-wise ANOVA, Extract Specific Tukey HSD Comparisons, and Calculate Log2 Fold Change}
\usage{
perform_rowwise_anova_tukey_fc(data_list, comparisons_list, feature_ids = NULL)
}
\arguments{
\item{data_list}{A named list of numeric data frames or matrices. Each element
represents a cohort (e.g., list(Q = Q_df, G = G_df, QZ = QZ_df, ...)).
All data frames must have the same number of rows, corresponding to the
same features (proteins) in the same order. Columns are replicates.
Input data is assumed to be log-transformed (e.g., log2).}

\item{comparisons_list}{A character vector listing the desired comparisons
in the format "Group1-Group2" (e.g., c("Q-G", "Q-QZ", "QZ-QAE")).
The fold change will be calculated as mean(Group1) - mean(Group2).}

\item{feature_ids}{An optional vector of feature identifiers (e.g., protein IDs,
gene names) corresponding to the rows of the data frames in `data_list`.
If provided, these will be included in the output data frame. Must have
the same length as the number of rows in the data frames.}
}
\value{
A data frame containing the results. If `feature_ids` were provided,
  the first column will be `FeatureID`. Subsequent columns correspond to the
  requested comparisons, with pairs of columns for log2 fold change (`_log2FC`)
  and adjusted p-value (`_p.adj`). Rows where analysis failed will have NA.
}
\description{
This function iterates through rows of a combined data matrix, performs
ANOVA across groups defined by a grouping factor, runs Tukey's HSD post-hoc
test, calculates the log2 fold change (difference of means, assuming log-transformed input)
for user-specified comparisons, and extracts adjusted p-values.
}
\examples{
# --- Create Sample Data (simulate user's dataframes on log2 scale) ---
set.seed(42)
n_proteins <- 50
Q <- as.data.frame(matrix(rnorm(n_proteins * 4, mean = 10, sd = 1), nrow = n_proteins))
G <- as.data.frame(matrix(rnorm(n_proteins * 5, mean = 11, sd = 1), nrow = n_proteins)) # G higher mean (log2FC ~1)
QZ <- as.data.frame(matrix(rnorm(n_proteins * 4, mean = 10, sd = 1), nrow = n_proteins))
QAE <- as.data.frame(matrix(rnorm(n_proteins * 3, mean = 9, sd = 1), nrow = n_proteins)) # QAE lower mean than QZ (log2FC ~ -1)
GX <- as.data.frame(matrix(rnorm(n_proteins * 5, mean = 11, sd = 1), nrow = n_proteins)) # Same as G
GYM <- as.data.frame(matrix(rnorm(n_proteins * 4, mean = 12, sd = 1), nrow = n_proteins)) # GYM higher mean than GX (log2FC ~ -1 for GX-GYM)

# Assign meaningful column names (optional but good practice)
colnames(Q) <- paste0("Q_", 1:ncol(Q))
colnames(G) <- paste0("G_", 1:ncol(G))
colnames(QZ) <- paste0("QZ_", 1:ncol(QZ))
colnames(QAE) <- paste0("QAE_", 1:ncol(QAE))
colnames(GX) <- paste0("GX_", 1:ncol(GX))
colnames(GYM) <- paste0("GYM_", 1:ncol(GYM))

# Create the input list
data_for_analysis <- list(
  Q = Q, G = G, QZ = QZ, QAE = QAE, GX = GX, GYM = GYM
)

# Define desired comparisons
my_comparisons <- c("Q-G", "Q-QZ", "QZ-QAE", "G-GX", "GX-GYM")

# Generate dummy protein IDs
protein_ids <- paste0("Prot_", 1:n_proteins)

# --- Run the function ---
analysis_results <- perform_rowwise_anova_tukey_fc(
  data_list = data_for_analysis,
  comparisons_list = my_comparisons,
  feature_ids = protein_ids
)

# --- View Results ---
print(head(analysis_results))
# Note columns like Q-G_log2FC and Q-G_p.adj
summary(analysis_results)

# Example: Filter for significant results with absolute log2FC > 1
# library(dplyr)
# significant_fc_Q_G <- analysis_results \%>\%
#   filter(`Q-G_p.adj` < 0.05 & abs(`Q-G_log2FC`) > 1)
# print(head(significant_fc_Q_G))
}
